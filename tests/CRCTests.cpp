#include <catch/catch.hpp>
#include <Package.hpp>

TEST_CASE( "CRC calculations", "[crc]" ) {
	SECTION( "Test pattern 1" ) {
		uint8_t data[] = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08 };
		auto crc = Package::calculateCRC(data, sizeof(data) / sizeof(data[0]));

		REQUIRE( crc == 0xB0);
	}

	SECTION( "Test pattern 2" ) {
		uint8_t data[] = {
				0x53, 0x70, 0x61, 0x63,
				0x65, 0x57, 0x69, 0x72,
				0x65, 0x20, 0x69, 0x73,
				0x20, 0x62, 0x65, 0x61,
				0x75, 0x74, 0x69, 0x66,
				0x75, 0x6C, 0x21, 0x21
		};
		auto crc = Package::calculateCRC(data, sizeof(data) / sizeof(data[0]));

		REQUIRE( crc == 0x84);
	}

	SECTION( "Test pattern 2" ) {
		uint8_t data[] = {
				0x10, 0x56, 0xC3, 0x95,
				0xA5, 0x75, 0x38, 0x63,
				0x2F, 0x86, 0x7B, 0x01,
				0x32, 0xDE, 0x35, 0x7A
		};
		auto crc = Package::calculateCRC(data, sizeof(data) / sizeof(data[0]));

		REQUIRE( crc == 0x18);
	}
}
